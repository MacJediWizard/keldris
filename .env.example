# ===================
# Keldris Configuration
# ===================

# Database
# IMPORTANT: Change 'changeme' to a strong password (both must match)
POSTGRES_PASSWORD=changeme
DATABASE_URL=postgres://keldris:changeme@db:5432/keldris?sslmode=disable
# POSTGRES_USER=keldris       # Override default PostgreSQL username
# POSTGRES_DB=keldris         # Override default database name

# OIDC Authentication (required)
# Supports Authentik, Keycloak, Okta, Auth0, Azure AD, Google Workspace
OIDC_ISSUER=https://auth.example.com/application/o/keldris/
OIDC_CLIENT_ID=your-client-id
OIDC_CLIENT_SECRET=your-client-secret
OIDC_REDIRECT_URL=http://localhost:8080/auth/callback

# Security
# SESSION_SECRET: openssl rand -base64 48
# ENCRYPTION_KEY: openssl rand -hex 32
SESSION_SECRET=generate-me-with-openssl-rand-base64-48
ENCRYPTION_KEY=generate-me-with-openssl-rand-hex-32

# Server
LISTEN_ADDR=:8080
GIN_MODE=release
# ENV=production  # Uncomment for production (enables Secure cookies, strict CORS, HSTS)
CORS_ORIGINS=http://localhost:8080,https://backup.example.com
# SERVER_PORT=8080  # Host port mapping for Docker (default: 8080)

# Optional: Redis for distributed rate limiting
# REDIS_URL=redis://localhost:6379

# Optional: SMTP for email notifications (configure via web UI, not env vars)
# These are shown for reference only â€” SMTP settings are managed in
# Settings > Notifications within the Keldris web interface.
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=notifications@example.com
# SMTP_PASSWORD=your-smtp-password
# SMTP_FROM=Keldris <notifications@example.com>

# Optional: Session configuration
# SESSION_MAX_AGE=86400
# SESSION_IDLE_TIMEOUT=1800

# Optional: Rate limiting
# RATE_LIMIT_REQUESTS=100
# RATE_LIMIT_PERIOD=1m

# Optional: Data retention
# RETENTION_DAYS=90

# Optional: Air-gapped deployment (no internet access)
# AIR_GAP_MODE=false

# Optional: License (managed via Settings > License in the web UI)
# LICENSE_SERVER_URL=                 # defaults to https://license.macjediwizard.com

# Agent configuration (used in docker-compose with agent profile)
# AGENT_API_KEY=your-agent-api-key
# BACKUP_SOURCE_PATH=/data  # Host path to back up (mounted read-only)
# =========================
# Database
DATABASE_URL=postgres://keldris:changeme@localhost:5432/keldris?sslmode=disable

# OIDC Authentication (required)
# Supports Authentik, Keycloak, Okta, Auth0, Azure AD, Google Workspace
OIDC_ISSUER=https://auth.example.com/application/o/keldris/
OIDC_CLIENT_ID=your-client-id
OIDC_CLIENT_SECRET=your-client-secret
OIDC_REDIRECT_URL=http://localhost:8080/auth/callback

# =========================
# Session
# =========================
# Secret key for session cookie encryption (use a random 32+ character string)
SESSION_SECRET=change-this-to-a-random-32-char-string
# Session lifetime in seconds (default: 86400 = 24 hours)
SESSION_MAX_AGE=86400

# =========================
# Encryption
# =========================
# AES-256-GCM key for encrypting sensitive data at rest (32 bytes, hex-encoded)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=
# Security (generate with: openssl rand -base64 32)
SESSION_SECRET=generate-a-32-byte-random-string
ENCRYPTION_KEY=generate-a-32-byte-base64-encoded-key

# Server
# =========================
# Environment: development, staging, production
# Set ENV=production and CORS_ORIGINS in production
ENV=development
# Address and port the server listens on
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:5173
# Log level: debug, info, warn, error
LOG_LEVEL=info

# =========================
# SMTP (optional)
# =========================
# Email server settings for notifications
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@example.com

# =========================
# License (optional)
# =========================
# Pro/Enterprise license key
LICENSE_KEY=

# =========================
# Telemetry (optional, default off)
# =========================
TELEMETRY_ENABLED=false
PORT=8080
GIN_MODE=release
CORS_ORIGINS=http://localhost:3000,https://backup.example.com

# Optional: Redis for distributed rate limiting
# REDIS_URL=redis://localhost:6379

# Optional: SMTP for email notifications
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=notifications@example.com
# SMTP_PASSWORD=your-smtp-password
# SMTP_FROM=Keldris <notifications@example.com>

# Optional: Session configuration
# SESSION_MAX_AGE=86400
# SESSION_IDLE_TIMEOUT=1800

# Optional: Rate limiting
# RATE_LIMIT_REQUESTS=100
# RATE_LIMIT_PERIOD=1m

# License (optional for Free tier)
# LICENSE_KEY=your-license-key
